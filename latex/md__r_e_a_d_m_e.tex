The {\bfseries Graduate School Application} is the online application form for applying to the University of Maine's Graduate School.

\section*{Setup}

\subsection*{Server Configuration}


\begin{DoxyItemize}
\item P\-H\-P $>$= 5.\-3
\item My\-S\-Q\-L
\item Apache 2.\-0 or equivalent
\begin{DoxyItemize}
\item rewrite module enabled
\item support for .htaccess files or server configuration to redirect all url requests to routes.\-php
\end{DoxyItemize}
\end{DoxyItemize}

\subsection*{Instructions}


\begin{DoxyEnumerate}
\item setup the database using the sql script \char`\"{}tests/gradschool\-\_\-application.\-sql\char`\"{}
\item Remove tests/
\item Check privleges and ownership on the folders within applicant\-\_\-files (if necessary move these outside the web root)
\item Configure the variables within application/libs/extern\-\_\-variables.\-php
\item move application/libs/extern\-\_\-variables.\-php outside the webroot and set the directory information inside application/libs/variables.\-php to point to extern\-\_\-variables
\item Schedule cron.\-php to run slightly after midnight
\item Complete an application and test submission as well as the payment process
\end{DoxyEnumerate}

\section*{Code Syntax}


\begin{DoxyEnumerate}
\item functions are in camel case
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item Database field names are referenced using $<$parent$>$-\/$<$parent$>$-\/$<$field\-Name$>$ format. e.\-g. application-\/personal-\/given\-Name
\begin{DoxyEnumerate}
\item Field name and parent name's are in camelcase
\end{DoxyEnumerate}
\end{DoxyEnumerate}

\section*{Architecture}

The application system uses the model view controller $<$abbr$>$(M\-V\-C)$<$/abbr$>$ pattern (\href{http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller}{\tt wikipedia definition}) to structure the system.

\subsection*{File Structure}


\begin{DoxyItemize}
\item {\bfseries \hyperlink{_r_e_a_d_m_e_8md}{R\-E\-A\-D\-M\-E.\-md}} This readme file
\item {\bfseries Application 2.\-0 Project Summary.\-md} A brief project overview document
\item $\ast$$\ast$.gitignore$\ast$$\ast$ Git file describing files to ignore from repository
\end{DoxyItemize}


\begin{DoxyItemize}
\item {\bfseries application/} The entire application codebase


\begin{DoxyItemize}
\item {\bfseries move\-\_\-outside\-\_\-webroot/} Files to place outside the webroot. Don't forget to update extern\-\_\-configuration.\-php and configuration.\-php!


\begin{DoxyItemize}
\item {\bfseries external\-Configuration.\-default.\-php} default configuration information for application.
\item {\bfseries external\-Configuration.\-php} The configuration information for this site. Be sure to copy the defaults in {\itshape external\-Configuration.\-default.\-php} and change values as necessary.
\item {\bfseries applicant\-\_\-files/} Contains folders for all applicant related files (essay, resume, recommendations, and pdf generated applications). This same folder is also used by the application management system for viewing data
\end{DoxyItemize}
\end{DoxyItemize}


\begin{DoxyItemize}
\item {\bfseries controllers/} Object classes for controlling applicant and application data access


\begin{DoxyItemize}
\item {\bfseries applicant\-Controller.\-php} Applicant manager with functions for logging in, registration, getting the active user, etc...
\item {\bfseries application\-Controller.\-php} Application manager for creating / deleting applications, getting the active application
\end{DoxyItemize}
\end{DoxyItemize}


\begin{DoxyItemize}
\item {\bfseries cron/} Scripts to be schedule for daily execution (sometime after midnight)


\begin{DoxyItemize}
\item {\bfseries cron.\-php} The primary cron script which runs all other specialized scripts (schedule O\-N\-L\-Y this script to be run daily)
\item {\bfseries mainestreet.\-php} Script run by cron.\-php which sends completed applications to Mainstreet as tab-\/separated text
\item {\bfseries app\-\_\-cleanup.\-php} Script run by cron.\-php to delete applications older than 6 months
\end{DoxyItemize}
\end{DoxyItemize}


\begin{DoxyItemize}
\item {\bfseries libraries/} External and internal code libraries used in the system


\begin{DoxyItemize}
\item {\bfseries M\-P\-D\-F52} External Library for generating pdf from html \href{http://www.mpdf1.com/mpdf/index.php}{\tt M\-P\-D\-F}
\item {\bfseries Slim} External Library for processing routing requests in application/routes.\-php \href{http://www.slimframework.com/}{\tt Slim}
\item {\bfseries Twig} External Library for rendering views using templates in application/views/templates \href{twig.sensiolabs.org}{\tt Twig}
\end{DoxyItemize}


\begin{DoxyItemize}
\item {\bfseries Database} Library for running sql queries on the database. Database configuration information is automatically loaded from configuration.\-php
\item {\bfseries Email} Library for sending emails. Works loosely like Twig by parsing email templates in application/views/templates/emails
\item {\bfseries Error} Library for gathering and rendering errors. Mostly used when registering or processing login requests
\item {\bfseries Error\-Tracker} Library for tracking errors
\item {\bfseries Hash} Library for encoding data
\item {\bfseries Input\-Sanitation} Library for filtering data. Used to filter data before storing in the database. Note that sql injection protection is performed by the Database function provided input is passed as
\end{DoxyItemize}
\end{DoxyItemize}


\begin{DoxyItemize}
\item {\bfseries models/} All data objects used in the application


\begin{DoxyItemize}
\item {\bfseries Model.\-php} A generic data object providing functions for loading/saving data from the database. If a model is tied to a database table, all of the fields for that database table are accessible as object properties.
\item {\bfseries Application\-Model.\-php} Application model used to access/save database fields
\item {\bfseries application\-Components/} Models representing components of the application
\item {\bfseries Applicant\-Model.\-php} Applicant model with basic applicant data
\item {\bfseries database\-Config.\-php} Not a model object. Describes which but a configuration script. Because this serves a database function and corresponds to the apps logic it falls within the models category.
\item {\bfseries Application\-Field\-Reference.\-php} Helper model for converting a reference to a database field into a usable object for setting and getting values. Used to communicate database fields between client and server (i.\-e. client can specify which language name needs to be updated)
\end{DoxyItemize}
\end{DoxyItemize}


\begin{DoxyItemize}
\item {\bfseries views/} Templates and supporint code for displaying data to the user


\begin{DoxyItemize}
\item {\bfseries javascript/} All javascript code
\item {\bfseries images/} Images for the website
\item {\bfseries css/} C\-S\-S styles for the site
\item {\bfseries templates/} \href{http://twig.sensiolabs.org}{\tt Twig} templates (H\-T\-M\-L) for forms, emails, and pages


\begin{DoxyItemize}
\item {\bfseries account/} Templates for account-\/based views
\item {\bfseries application/} All application templates


\begin{DoxyItemize}
\item {\bfseries repeatable/} Templates for application components that can repeat
\item {\bfseries payment\-Response.\-twig} Template used when user returns to application from the Touchnet payment process
\item {\bfseries section.\-macro.\-twig} Helper template functions for application views
\item {\bfseries section.\-twig} Template structure for all major application sections
\item {\bfseries pdf.\-twig} Template defining the pdf output
\end{DoxyItemize}
\end{DoxyItemize}


\begin{DoxyItemize}
\item {\bfseries emails/} All email templates. This does not use Twig -\/$>$ see application/libraries/\-Email.\-php for more details.
\item {\bfseries letter\-Of\-Recommendation/} Templates for forms and pages relating to references filling out a letter of recommendation
\item {\bfseries page\-Layout.\-twig} Template structure that all other templates derive from
\item {\bfseries forms.\-macro.\-twig} Helper template functions for forms
\item {\bfseries no\-Javascript.\-twig} Template for when user does not have javascript enabled
\end{DoxyItemize}
\end{DoxyItemize}
\end{DoxyItemize}


\begin{DoxyItemize}
\item $\ast$$\ast$.htaccess$\ast$$\ast$ Tells Apache to redirect all url requests to routes.\-php
\item {\bfseries configuration.\-php} Configuration file pointing to the external\-Configuration.\-php file. This file is referenced when configuration data is needed instead of external\-Configuration.\-php
\item {\bfseries robots.\-txt} List describing which directories for search engines to exclude
\item {\bfseries routes.\-php} The core of the application and where every request for the application comes first.
\end{DoxyItemize}
\end{DoxyItemize}


\begin{DoxyItemize}
\item {\bfseries development/} Development information including database details and code tests


\begin{DoxyItemize}
\item {\bfseries chromephp/} Development library for outputing php data to chrome console. See \href{http://www.chromephp.com/}{\tt http\-://www.\-chromephp.\-com/}.
\item {\bfseries database/} Database definitions and conversion from app v1 to app v2


\begin{DoxyItemize}
\item {\bfseries application1.\-0.\-mwb} My\-S\-Q\-L workbench file describing the database schema for application v1 \href{http://dev.mysql.com/downloads/workbench/}{\tt My\-S\-Q\-L Workbench}
\item {\bfseries application2.\-0.\-mwb} My\-S\-Q\-L workbench file describing the database schema and default data for application v2 \href{http://dev.mysql.com/downloads/workbench/}{\tt My\-S\-Q\-L Workbench}
\end{DoxyItemize}
\end{DoxyItemize}


\begin{DoxyItemize}
\item {\bfseries migration/} Migration guides when moving from application v1 to application v2
\end{DoxyItemize}


\begin{DoxyItemize}
\item {\bfseries tests/} Unit tests made using \href{http://www.phpunit.de/manual/current/en/index.html}{\tt P\-H\-P Unit}
\end{DoxyItemize}
\end{DoxyItemize}

\subsection*{Routes.\-php}

Routes.\-php is the core of the application and where every request for the application comes first.

Requests made to the application come in two two flavors\-:

\subsubsection*{Page Requests}

{\itshape Page requests} retrieve viewable webpages from the application for the user to explore in their browser.

All {\itshape page requests} are implemented in routes.\-php and are H\-T\-T\-P get requests programmed using the following format\-: \begin{DoxyVerb}    $app->get('<url here>', $optionalAuthenticationFunction, function() { 

        // Logic here
        // May use controllers to retrieve data

        render('templatePath', $arrayHoldingTemplateReplacementData ); 
    });
\end{DoxyVerb}


\subsubsection*{Data Submissions}

{\itshape Data submissions} are responses from the user sending data to the server for processing. Examples include submitting form data, saving database fields, deleting application sections, and payment response processing.

All {\itshape data submissions} are implemented in routes.\-php and are H\-T\-T\-P post requests programmed using the following format\-: \begin{DoxyVerb}    $app->post('<url here>', $optionalAuthenticationFunction, function() { 

        // Logic here
        // May use controllers to submit data

        // may or may not return a response or render a view for user depending
        echo "<response>"; 
        // or 
        render('templatePath', $arrayHoldingTemplateReplacementData );          
    });
\end{DoxyVerb}


\subsubsection*{Note}

As part of the site configuration, the .htaccess file's exists to redirect all url requests to routes.\-php according to Apache 2's rewrite rules. If application url requests do not function at all, the server needs to be configured to either allow the .htacess files, or redirect url requests to routes.\-php. If this is not an option, alternatively you can change the webroot in external\-Configuration.\-php to \href{http://}{\tt http\-://}$<$webroot\-\_\-here$>$/routes.php. The urls will not be as pretty but the application should function properly.

\subsection*{Views}

Views (also known as templates) are the display containers of the application.

Templates are implemented using the Twig framework. Twig allows inheriting templates, variable replacement, basic looping and conditional statements, data filtering, and much more. See \href{http://twig.sensiolabs.org/}{\tt Twig Home} for additional details.

The Twig library can be found found in /libs/\-Twig and /libs/\-Slim/\-Twig.php. /libs/\-Slim/\-Twig.php allows Twig's to be rendered by the slim instance \$app using the \$app-\/$>$render function. In this application, \$app-\/$>$render is not called directly. Instead, a custom function, render, is used to make the following variables available to every template\-:


\begin{DoxyItemize}
\item {\bfseries W\-E\-B\-R\-O\-O\-T} -\/ The full url path to the root directory of the application. This is used for correctly building all links and references in templates.
\item {\bfseries G\-R\-A\-D\-H\-O\-M\-E\-P\-A\-G\-E} -\/ the full url to the graduate school's website
\item {\bfseries C\-S\-S\-P\-A\-T\-H} -\/ The full url to the application's css folder
\item {\bfseries J\-S\-P\-A\-T\-H} -\/ The full url to the application's javascript folder
\item {\bfseries I\-M\-A\-G\-E\-P\-A\-T\-H} -\/ The full url to the application's images folder
\item {\bfseries I\-S\-L\-O\-G\-G\-E\-D\-I\-N} -\/ A boolean value indicating if the user is currently logged
\item {\bfseries E\-M\-A\-I\-L} -\/ The email of the current user. This value is only available if the user is logged in.
\end{DoxyItemize}

\subsubsection*{Notes}


\begin{DoxyItemize}
\item Templates are either used directly or define a structure to be used by a child template (layout templates). Layout templates are defined using the syntax $<$name$>$Layout.\-twig where $<$name$>$ is a camel case descriptive template name. For example, forgotten\-Layout.\-twig defines the forgotten template used by templates describing specific responses during the process of retrieving a forgotten password.
\end{DoxyItemize}


\begin{DoxyItemize}
\item Template names follow the same format as database field names. For example, the template account/forgotten-\/error.\-twig belongs to the account category, is descended from the forgotten template file (called forgotten\-Layout), and is called error.
\end{DoxyItemize}

\section*{Notes}